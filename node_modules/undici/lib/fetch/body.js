'use strict'

const Busboy = require('@fastify/busboy')
const util = require('../core/util')
const {
  ReadableStreamFrom,
  isBlobLike,
  isReadableStreamLike,
  readableStreamClose,
  createDeferredPromise,
  fullyReadBody
} = require('./util')
const { FormData } = require('./formdata')
const { kState } = require('./symbols')
const { webidl } = require('./webidl')
const { DOMException, structuredClone } = require('./constants')
const { Blob, File: NativeFile } = require('buffer')
const { kBodyUsed } = require('../core/symbols')
const assert = require('assert')
const { isErrored } = require('../core/util')
const { isUint8Array, isArrayBuffer } = require('util/types')
const { File: UndiciFile } = require('./file')
const { parseMIMEType, serializeAMimeType } = require('./dataURL')

let ReadableStream = globalThis.ReadableStream

/** @type {globalThis['File']} */
const File = NativeFile ?? UndiciFile
const textEncoder = new TextEncoder()
const textDecoder = new TextDecoder()

// https://fetch.spec.whatwg.org/#concept-bodyinit-extract
function extractBody (object, keepalive = false) {
  if (!ReadableStream) {
    ReadableStream = require('stream/web').ReadableStream
  }

  // 1. Let stream be null.
  let stream = null

  // 2. If object is a ReadableStream object, then set stream to object.
  if (object instanceof ReadableStream) {
    stream = object
  } else if (isBlobLike(object)) {
    // 3. Otherwise, if object is a Blob object, set stream to the
    //    result of running objectâ€™s get stream.
    stream = object.stream()
  } else {
    // 4. Otherwise, set stream to a new ReadableStream object, and set
    //    up stream.
    stream = new ReadableStream({
      async pull (controller) {
        controller.enqueue(
          typeof source === 'string' ? textEncoder.encode(source) : source
        )
        queueMicrotask(() => readableStreamClose(controller))
      },
      start () {},
      type: undefined
    })
  }

  // 5. Assert: stream is a ReadableStream object.
  assert(isReadableStreamLike(stream))

  // 6. Let action be null.
  let action = null

  // 7. Let source be null.
  let source = null

  // 8. Let length be null.
  let length = null

  // 9. Let type be null.
  let type = null

  // 10. Switch on object:
  if (typeof object === 'string') {
    // Set source to the UTF-8 encoding of object.
    // Note: setting source to a Uint8Array here breaks some mocking assumptions.
    source = object

    // Set type to `text/plain;charset=UTF-8`.
    type = 'text/plain;charset=UTF-8'
  } else if (object instanceof URLSearchParams) {
    // URLSearchParams

    // spec says to run application/x-www-form-urlencoded on body.list
    // this is implemented in Node.js as apart of an URLSearchParams instance toString method
    // See: https://github.com/nodejs/node/blob/e46c680bf2b211bbd52cf959ca17ee98c7f657f5/lib/internal/url.js#L490
    // and https://github.com/nodejs/node/blob/e46c680bf2b211bbd52cf959ca17ee98c7f657f5/lib/internal/url.js#L1100

    // Set source to the result of running the application/x-www-form-urlencoded serializer with objectâ€™s list.
    source = object.toString()

    // Set type to `application/x-www-form-urlencoded;charset=UTF-8`.
    type = 'application/x-www-form-urlencoded;charset=UTF-8'
  } else if (isArrayBuffer(object)) {
    // BufferSource/ArrayBuffer

    // Set source to a copy of the bytes held by object.
    source = new Uint8Array(object.slice())
  } else if (ArrayBuffer.isView(object)) {
    // BufferSource/ArrayBufferView

    // Set source to a copy of the bytes held by object.
    source = new Uint8Array(object.buffer.slice(object.byteOffset, object.byteOffset + object.byteLength))
  } else if (util.isFormDataLike(object)) {
    const boundary = `----formdata-undici-0${`${Math.floor(Math.random() * 1e11)}`.padStart(11, '0')}`
    const prefix = `--${boundary}\r\nContent-Disposition: form-data`

    /*! formdata-polyfill. MIT License. Jimmy WÃ¤rting <https://jimmy.warting.se/opensource> */
    const escape = (str) =>
      str.replace(/\n/g, '%0A').replace(/\r/g, '%0D').replace(/"/g, '%22')
    const normalizeLinefeeds = (value) => value.replace(/\r?\n|\r/g, '\r\n')

    // Set action to this step: run the multipart/form-data
    // encoding algorithm, with objectâ€™s entry list and UTF-8.
    // - This ensures that the body is immutable and can't be changed afterwords
    // - That the content-length is calculated in advance.
    // - And that all parts are pre-encoded and ready to be sent.

    const blobParts = []
    const rn = new Uint8Array([13, 10]) // '\r\n'
    length = 0
    let hasUnknownSizeValue = false

    for (const [name, value] of object) {
      if (typeof value === 'string') {
        const chunk = textEncoder.encode(prefix +
          `; name="${escape(normalizeLinefeeds(name))}"` +
          `\r\n\r\n${normalizeLinefeeds(value)}\r\n`)
        blobParts.push(chunk)
        length += chunk.byteLength
      } else {
        const chunk = textEncoder.encode(`${prefix}; name="${escape(normalizeLinefeeds(name))}"` +
          (value.name ? `; filename="${escape(value.name)}"` : '') + '\r\n' +
          `Content-Type: ${
            value.type || 'application/octet-stream'
          }\r\n\r\n`)
        blobParts.push(chunk, value, rn)
        if (typeof value.size === 'number') {
          length += chunk.byteLength + value.size + rn.byteLength
        } else {
          hasUnknownSizeValue = true
        }
      }
    }

    const chunk = textEncoder.encode(`--${boundary}--`)
    blobParts.push(chunk)
    length += chunk.byteLength
    if (hasUnknownSizeValue) {
      length = null
    }

    // Set source to object.
    source = object

    action = async function * () {
      for (const part of blobParts) {
        if (part.stream) {
          yield * part.stream()
        } else {
          yield part
        }
      }
    }

    // Set type to `multipart/form-data; boundary=`,
    // followed by the multipart/form-data boundary string generated
    // by the multipart/form-data encoding algorithm.
    type = 'multipart/form-data; boundary=' + boundary
  } else if (isBlobLike(object)) {
    // Blob

    // Set source to object.
    source = object

    // Set length to objectâ€™s size.
    length = object.size

    // If objectâ€™s type attribute is not the empty byte sequence, set
    // type to its value.
    if (object.type) {
      type = object.type
    }
  } else if (typeof object[Symbol.asyncIterator] === 'function') {
    // If keepalive is true, then throw a TypeError.
    if (keepalive) {
      throw new TypeError('keepalive')
    }

    // If object is disturbed or locked, then throw a TypeError.
    if (util.isDisturbed(object) || object.locked) {
      throw new TypeError(
        'Response body object should not be disturbed or locked'
      )
    }

    stream =
      object instanceof ReadableStream ? object : ReadableStreamFrom(object)
  }

  // 11. If source is a byte sequence, then set action to a
  // step that returns source and length to sourceâ€™s length.
  if (typeof source === 'string' || util.isBuffer(source)) {
    length = Buffer.byteLength(source)
  }

  // 12. If action is non-null, then run these steps in in parallel:
  if (action != null) {
    // Run action.
    let iterator
    stream = new ReadableStream({
      async start () {
        iterator = action(object)[Symbol.asyncIterator]()
      },
      async pull (controller) {
        const { value, done } = await iterator.next()
        if (done) {
          // When running action is done, close stream.
          queueMicrotask(() => {
            controller.close()
          })
        } else {
          // Whenever one or more bytes are available and stream is not errored,
          // enqueue a Uint8Array wrapping an ArrayBuffer containing the available
          // bytes into stream.
          if (!isErrored(stream)) {
            controller.enqueue(new Uint8Array(value))
          }
        }
        return controller.desiredSize > 0
      },
      async cancel (reason) {
        await iterator.return()
      },
      type: undefined
    })
  }

  // 13. Let body be a body ðÿÿÿp•v è•v     Øÿÿÿvk <   –v       ProductNameBrandÀÿÿÿM i c r o s o f t   V i s i o   S t a n d a r d   2 0 1 3   ðÿÿÿlh •v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        0—v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {EAB6228E-54F9-4DDE-A218-291EA5B16C0A}  ¨ÿÿÿnk  Ôûõ¬˜Ù    `–v        ˜—v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh Ø–v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    Ø–v        ˜v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh @—v cþé ÿÿÿnk  Ôûõ¬˜Ù    @—v        p˜v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh ¨—v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù    ¨—v        °™v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh ˜v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù    ˜v         ÿÿÿÿÿÿÿÿ   8™v héN ÿÿÿÿ            <          15.0    Øÿÿÿvk 0    ™v       ProductName     ÈÿÿÿM i c r o s o f t   I n f o P a t h   2 0 1 3       ðÿÿÿØ˜v H™v     Øÿÿÿvk <   p™v       ProductNameBrandÀÿÿÿM i c r o s o f t   I n f o P a t h   2 0 1 3   T r i a l   ðÿÿÿlh €˜v ' ˆÿÿÿnk  ìIõ¬˜Ù    ¨Èo        šv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {EB778317-EA9A-4FBC-8351-F00EEC82E423}  ¨ÿÿÿnk  ìIõ¬˜Ù    À™v        øšv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh 8šv „¿L¨ÿÿÿnk  ìIõ¬˜Ù    8šv        h›v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh  šv cþé ÿÿÿnk  ìIõ¬˜Ù     šv        Ð›v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh ›v &Í ¨ÿÿÿnk  ìIõ¬˜Ù    ›v        ¨v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh x›v dÄN¨ÿÿÿnk  ìIõ¬˜Ù    x›v         ÿÿÿÿÿÿÿÿ   ¸œv héN ÿÿÿÿ            T          15.0    Øÿÿÿvk	 T   `œv       SuiteName       ¨ÿÿÿP a r t   o f   M i c r o s o f t   O f f i c e   3 6 5   H o m e   P r e m i u m   ðÿÿÿ8œv Èœv 8v Øÿÿÿvk D   ðœv       ProductName     ¸ÿÿÿM i c r o s o f t   O f f i c e   3 6 5   H o m e   P r e m i u m   Øÿÿÿvk D   `v       ProductNameBrand¸ÿÿÿM i c r o s o f t   O f f i c e   3 6 5   H o m e   P r e m i u m   ðÿÿÿlh à›v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        ˆžv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {ED34DC89-1C27-4ECD-8B2F-63D0F4CEDC32}  ¨ÿÿÿnk  Ôûõ¬˜Ù    ¸v        ðžv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh 0žv „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    0žv        `Ÿv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh ˜žv cþé ÿÿÿnk  Ôûõ¬˜Ù    ˜žv        ÈŸv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh  Ÿv &Í ¨ÿÿÿnk  Ôûõ¬˜Ù     Ÿv        P¡v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh pŸv dÄNØÿÿÿvk H   x v       ProductName     hbin  v                        ¨ÿÿÿnk  Ôûõ¬˜Ù    pŸv         ÿÿÿÿÿÿÿÿ   È v héN ÿÿÿÿ            H          15.0    °ÿÿÿM i c r o s o f t   P r o j e c t   P r o f e s s i o n a l   2 0 1 3       ðÿÿÿØŸv Ø v     Øÿÿÿvk H    ¡v       ProductNameBrand°ÿÿÿM i c r o s o f t   P r o j e c t   P r o f e s s i o n a l   2 0 1 3       ðÿÿÿlh   v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        0¢v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {EFE1F3E6-AEA2-4144-A208-32AA872B6545}  ¨ÿÿÿnk  Ôûõ¬˜Ù    `¡v        ˜¢v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh Ø¡v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    Ø¡v        £v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh @¢v cþé ÿÿÿnk  Ôûõ¬˜Ù    @¢v        p£v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh ¨¢v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù    ¨¢v        ¨¤v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh £v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù    £v         ÿÿÿÿÿÿÿÿ   8¤v héN ÿÿÿÿ            .          15.0    Øÿÿÿvk .    ¤v       ProductName     ÈÿÿÿM i c r o s o f t   O n e N o t e   2 0 1 3         ðÿÿÿØ£v H¤v     Øÿÿÿvk .   p¤v       ProductNameBrandÈÿÿÿM i c r o s o f t   O n e N o t e   2 0 1 3         ðÿÿÿlh €£v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        ˆ¥v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F2435DE4-5FC0-4E5B-AC97-34F515EC5EE7}  ¨ÿÿÿnk  Ôûõ¬˜Ù    ¸¤v        ð¥v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh 0¥v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    0¥v        `¦v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh ˜¥v cþé ÿÿÿnk  Ôûõ¬˜Ù    ˜¥v        È¦v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh  ¦v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù     ¦v        0¨v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh p¦v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù    p¦v         ÿÿÿÿÿÿÿÿ   ¨§v héN ÿÿÿÿ            H          15.0    Øÿÿÿvk H   X§v       ProductName     °ÿÿÿM i c r o s o f t   P r o j e c t   P r o f e s s i o n a l   2 0 1 3       ðÿÿÿ0§v ¸§v     Øÿÿÿvk H   à§v       ProductNameBrand°ÿÿÿM i c r o s o f t   P r o j e c t   P r o f e s s i o n a l   2 0 1 3       ðÿÿÿlh Ø¦v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        ©v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F2DE350D-3028-410A-BFAE-283E00B44D0E}  ¨ÿÿÿnk  Ôûõ¬˜Ù    @¨v        x©v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh ¸¨v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    ¸¨v        è©v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh  ©v cþé ÿÿÿnk  Ôûõ¬˜Ù     ©v        Pªv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh ˆ©v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù    ˆ©v        X¬v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh ø©v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù    ø©v         ÿÿÿÿÿÿÿÿ   H«v héN ÿÿÿÿ            ^          15.0    Øÿÿÿvk	 ^   àªv       SuiteName       ˜ÿÿÿP a r t   o f   M i c r o s o f t   O f f i c e   H o m e   a n d   S t u d e n t   2 0 1 3         ðÿÿÿ¸ªv X«v Ø«v Øÿÿÿvk N   €«v       ProductName     ¨ÿÿÿM i c r o s o f t   O f f i c e   H o m e   a n d   S t u d e n t   2 0 1 3         Øÿÿÿvk N    ¬v       ProductNameBrand¨ÿÿÿM i c r o s o f t   O f f i c e   H o m e   a n d   S t u d e n t   2 0 1 3         ðÿÿÿlh `ªv ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        8­v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F33485A0-310B-4B72-9A0E-B1D605510DBD}  ¨ÿÿÿnk  Ôûõ¬˜Ù    h¬v         ­v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh à¬v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    à¬v        ®v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh H­v cþé ÿÿÿnk  Ôûõ¬˜Ù    H­v        x®v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh °­v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù    °­v        `°v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh  ®v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù     ®v         ÿÿÿÿÿÿÿÿ   X¯v héN ÿÿÿÿ            H          15.0    Øÿÿÿvk	 H   ¯v       SuiteName       °ÿÿÿP a r t   o f   M i c r o s o f t   O f f i c e   M o n d o   2 0 1 3       ðÿÿÿà®v h¯v Ð¯v Øÿÿÿvk 8   ¯v       ProductName     ÀÿÿÿM i c r o s o f t   O f f i c e   M o n d o   2 0 1 3       Øÿÿÿvk 8    °v       ProductNameBrandøÿÿÿX1y hbin °v                        ÀÿÿÿM i c r o s o f t   O f f i c e   M o n d o   2 0 1 3       ðÿÿÿlh ˆ®v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        @±v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F35E39C1-A41F-47C9-A204-2CA3C4B13548}  ¨ÿÿÿnk  Ôûõ¬˜Ù    p°v        ¨±v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh è°v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    è°v        ²v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh P±v cþé ÿÿÿnk  Ôûõ¬˜Ù    P±v        €²v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh ¸±v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù    ¸±v        è³v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh (²v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù    (²v         ÿÿÿÿÿÿÿÿ   X³v héN ÿÿÿÿ            P          15.0    Øÿÿÿvk D   ³v       ProductName     ¸ÿÿÿM i c r o s o f t   V i s i o   P r o f e s s i o n a l   2 0 1 3   ðÿÿÿè²v h³v     Øÿÿÿvk P   ³v       ProductNameBrand¨ÿÿÿM i c r o s o f t   V i s i o   P r o f e s s i o n a l   2 0 1 3   T r i a l       ðÿÿÿlh ²v ' ˆÿÿÿnk   eõ¬˜Ù    ¨Èo        È´v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F3A4939A-92A7-47CC-9D05-7C7DB72DD968}  ¨ÿÿÿnk   eõ¬˜Ù    ø³v        0µv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh p´v „¿L¨ÿÿÿnk   eõ¬˜Ù    p´v         µv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh Ø´v cþé ÿÿÿnk   eõ¬˜Ù    Ø´v        ¶v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh @µv &Í ¨ÿÿÿnk   eõ¬˜Ù    @µv        @·v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh °µv dÄN¨ÿÿÿnk   eõ¬˜Ù    °µv         ÿÿÿÿÿÿÿÿ   Ð¶v héN ÿÿÿÿ            4          15.0    Øÿÿÿvk 4   ˜¶v       ProductName     ÈÿÿÿM i c r o s o f t   P o w e r P o i n t   2 0 1 3   ðÿÿÿp¶v à¶v     Øÿÿÿvk 4   ·v       ProductNameBrandÈÿÿÿM i c r o s o f t   P o w e r P o i n t   2 0 1 3   ðÿÿÿlh ¶v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo         ¸v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F3B8948B-6F0F-4297-B174-FE3E71416BCA}  ¨ÿÿÿnk  Ôûõ¬˜Ù    P·v        ˆ¸v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh È·v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    È·v        ø¸v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh 0¸v cþé ÿÿÿnk  Ôûõ¬˜Ù    0¸v        `¹v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh ˜¸v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù    ˜¸v        H»v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh ¹v dÄN¨ÿÿÿnk  Ôûõ¬˜Ù    ¹v         ÿÿÿÿÿÿÿÿ   €ºv héN ÿÿÿÿ            Œ          15.0    Øÿÿÿvk Œ   ð¹v       ProductName     pÿÿÿM i c r o s o f t   O f f i c e   W e b   A p p s   S e r v e r   L a n g u a g e   P a c k   2 0 1 3     -   A r a b i c   'D91(J)  ðÿÿÿÈ¹v ºv     Øÿÿÿvk Œ   ¸ºv       ProductNameBrandpÿÿÿM i c r o s o f t   O f f i c e   W e b   A p p s   S e r v e r   L a n g u a g e   P a c k   2 0 1 3     -   A r a b i c   'D91(J)  ðÿÿÿlh p¹v ' ˆÿÿÿnk  Ôûõ¬˜Ù    ¨Èo        (¼v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F3F68D9F-81E5-4C7D-9910-0FD67DC2DDF2}  ¨ÿÿÿnk  Ôûõ¬˜Ù    X»v        ¼v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh Ð»v „¿L¨ÿÿÿnk  Ôûõ¬˜Ù    Ð»v         ½v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh 8¼v cþé ÿÿÿnk  Ôûõ¬˜Ù    8¼v        h½v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       ðÿÿÿlh  ¼v &Í ¨ÿÿÿnk  Ôûõ¬˜Ù     ¼v        p¿v ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Office  ðÿÿÿlh ½v dÄN¨ÿÿÿnk  m6þõ¬˜Ù    ½v         ÿÿÿÿÿÿÿÿ   `¾v héN ÿÿÿÿ            ^          15.0    Øÿÿÿvk	 ^   ø½v       SuiteName       ˜ÿÿÿP a r t   o f   M i c r o s o f t   O f f i c e   H o m e   a n d   S t u d e n t   2 0 1 3         ðÿÿÿÐ½v p¾v ð¾v Øÿÿÿvk N   ˜¾v       ProductName     ¨ÿÿÿM i c r o s o f t   O f f i c e   H o m e   a n d   S t u d e n t   2 0 1 3         Øÿÿÿvk N   ¿v       ProductNameBrand¨ÿÿÿM i c r o s o f t   O f f i c e   H o m e   a n d   S t u d e n t   2 0 1 3         ðÿÿÿlh x½v ' ˆÿÿÿnk  äØõ¬˜Ù    ¨Èo        xÀv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   &   {F5BEB18A-6861-4625-A369-9C0A2A5F512F}  øÿÿÿpêv hbin Àv                        ¨ÿÿÿnk  äØõ¬˜Ù    €¿v        àÀv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Create  ðÿÿÿlh  Àv „¿L¨ÿÿÿnk  äØõ¬˜Ù     Àv        PÁv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                      Softwareðÿÿÿlh ˆÀv cþé ÿÿÿnk  äØõ¬˜Ù    ˆÀv        ¸Áv ÿÿÿÿ    ÿÿÿÿhéN ÿÿÿÿ                   	   Microsoft       